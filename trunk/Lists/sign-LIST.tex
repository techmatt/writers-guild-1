 %%%%
%%
%% This file sets up the Sign and Label datatypes and creates Sign and
%% Label macros.
%%
%% Signs generally represent interesting parts of game area, usually
%% as things posted on walls.  Labels represent other things, often on
%% or inside envelopes, that are part of complex mechanics.
%%
%% The default value for \MYloc will inherit location from the Place
%% or Sign most immediately up the ownership tree.  Override this by
%% setting \MYloc to anything (even blank).
%%
%% Sign is for full-sized signs that would cover most of a large
%% manila envelope; SignMedium is for signs sized to half-sized manila
%% envelopes; SignSmall is for signs sized for small manila envelopes
%% (the same size as item cards).  Label, LabelMedium, and LabelSmall
%% are analagous, but they don't have a \takedownby note at the
%% bottom.  You can always use a sign or label without an envelope or
%% with a differently-sized envelope.  Choose which based on
%% visibility and content.
%%
%% SignTiny is for signs you want to be hard to find; it is small and
%% does not have a \takedownby note.  SignDot is for a very small
%% "dot" which only has a title.
%%
%% SignStrip produces a strip of paper (without a \takedownby note)
%% with labels on the outside that show on both sides if you fold it
%% in half.  These are a convenient alternative to sub-envelopes. They
%% can also be used for "s-packets" taped to walls (see
%% Extras/README-s-packets).
%%
%% LabelCover produces a label similar to the cover to a research
%% notebook.  LabelPage, likewise, produces a page.
%%
%% EOG is for full-sized end-of-game signs.
%%
%%%%%

\DECLARESUBTYPE{Sign}{Element}
\PRESETS{Sign}{
  \FD\MYloc	{\mylocation} %% real-space location
  \FD\MYtext	{} %% text of sign
  }
\POSTSETS{Sign}{
  \edef\mylocation{\MYloc}
  \protected@edef\@ownerstring{%
    \MYname%
    \ifx\mylocation\empty\else\ (\mylocation)\fi%
    }
  }
\def\mylocation{}

\def\loc#1{\rs\MYloc{#1}}

\DECLARESUBTYPE{SignMedium}{Sign}
\DECLARESUBTYPE{SignSmall}{Sign}
\DECLARESUBTYPE{SignTiny}{Sign}
\DECLARESUBTYPE{SignDot}{Sign}
\PRESETS{SignDot}{\s\MYtext{}}

\DECLARESUBTYPE{Label}{Sign}
\PRESETS{Label}{\s\MYloc{}}
\DECLARESUBTYPE{LabelMedium}{Label}
\DECLARESUBTYPE{LabelSmall}{Label}

\DECLARESUBTYPE{SignStrip}{Sign}
\DECLARESUBTYPE{LabelCover}{Label}
\DECLARESUBTYPE{LabelPage}{Label}

\DECLARESUBTYPE{EOG}{Sign}
\PRESETS{EOG}{%
  \s\MYname	{End Of Game}
  \s\MYtext	{{\bf\Huge You may not pass through here.}}
  }


%%%%%
%% \signbig[<location>]{<name>}{<text>}
%% \eog[<location>]
%%
%% \signmdeium[<location>]{<name>}{<text>}
%% \signsmall[<location>]{<name>}{<text>}
%% \signtiny[<location>]{<name>}{<text>}
%% \signdot[<location>]{<name>}
%%
%% \labelbig{<name>}{<text>}
%% \labelmedium{<name>}{<text>}
%% \labelsmall{<name>}{<text>}
%%
%% \signstrip[<location>]{<name>}{<text>}
%% \labelcover{<name>}{<text>}
%% \labelpage{<name>}{<text>}
\newinstance{Sign}{\signbig[3][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}\s\MYtext{#3}}
\newinstance{EOG}{\eog[1][\mylocation]}{\s\MYloc{#1}}

\newinstance{SignMedium}{\signmedium[3][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}\s\MYtext{#3}}
\newinstance{SignSmall}{\signsmall[3][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}\s\MYtext{#3}}
\newinstance{SignTiny}{\signtiny[3][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}\s\MYtext{#3}}
\newinstance{SignDot}{\signdot[2][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}}

\newinstance{Label}{\labelbig[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{LabelMedium}{\labelmedium[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{LabelSmall}{\labelsmall[2]}{
  \s\MYname{#1}\s\MYtext{#2}}

\newinstance{SignStrip}{\signstrip[3][\mylocation]}{
  \s\MYloc{#1}\s\MYname{#2}\s\MYtext{#3}}
\newinstance{LabelCover}{\labelcover[2]}{
  \s\MYname{#1}\s\MYtext{#2}}
\newinstance{LabelPage}{\labelpage[2]}{
  \s\MYname{#1}\s\MYtext{#2}}


%%%%%
%% \sEOG{}
%% use \sEOg[\loc{<location>}]{} for EOG sign at a specific place
\NEW{EOG}{\sEOG}{
  }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\NEW{Sign}{\sTest}{
%  \s\MYname	{A Room}
%  \s\MYloc	{10-250}
%  \s\MYtext	{A lecture hall with large, sliding blackboards.}
%  }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\NEW{Sign}{\sBatterySource}{%%3 sources in game, each has 3 batteries, for a total of 9 available in game.
  \s\MYname	{A Chemical Stock Room}
  \s\MYloc	{200-002}
  \s\MYtext	{This chemical stock room has sulfuric acid in it. You can build a battery here. To do so, take 2 minutes and consume 1 copper (item number: \iCopper{\MYnumber{}}), and 1 zinc (item number: \iZinc{\MYnumber{}}) (tear them up), then take a battery (item number:\iBattery{\MYnumber{}}).} If this location has no batteries available, all of the sulfuric acid has been consumed and you must find another source.
  \s\MYitems  {\multi{3}{\iBattery{}}}
  }

\NEW{Sign}{\sConduitLocatingNumber}{
  \s\MYname	{Machine Display}
  \s\MYloc	{}
  \s\MYtext	{{\Huge 487}}
}

%%need to assign to locations
\NEW{Sign}{\sLocationCoverSheet}{
  \s\MYname	{A Possible Location of Closest Contact.}
  \s\MYloc	{}%%TBD
  \s\MYtext	{It is possible that the conduit can be opened from this location. {\bf You must have an item capable of determining the ``Point of Closest Contact'' in order to find out.}} 
}

%%Some error about \noalign
\NEW{SignMedium}{\sConduitOne}{
  \s\MYname	{A Possible Location of Closest Contact.}
  \s\MYloc	{}%%TBD
  \s\MYtext	{To determine if this is the current location of closest contact, search the chart below for the number associated with the current time. The number associated with the current time is the {\bf only} active number. Numbers associated with previous or future time slots are not active.
  
\begin{tabular}{ l || l }
  Time: & Active Number  \\ \hline \hline
  2:00-2:30 & 2922 \\ \hline
  2:30-3:00 & 7726 \\ \hline
  3:00-3:30 & 9826 \\ \hline
  3:30-4:00 & 1820 \\ \hline
  4:00-4:30 & 9291 \\ \hline
  4:30-5;00 & 1276 \\ \hline
  5:00-5:30 & 7865 \\ \hline
  5:30-6:00 & 9844 \\ \hline
\end{tabular}  } 
  }
  
\NEW{SignMedium}{\sConduitTwo}{
  \s\MYname	{A Possible Location of Closest Contact.}
  \s\MYloc	{}%%TBD
  \s\MYtext	{To determine if this is the current location of closest contact, search the chart below for the number associated with the current time. The number associated with the current time is the {\bf only} active number. Numbers associated with previous or future time slots are not active.
  
\begin{tabular}{ l || l }
  Time: & Active Number  \\ \hline \hline
  2:00-2:30  & 8766 \\ \hline
  2:30-3:00  & 1542 \\ \hline
  3:00-3:30  & 4098 \\ \hline
  3:30-4:00  & 1052 \\ \hline
  4:00-4:30  & 2242 \\ \hline
  4:30-5:00  & 3391 \\ \hline
  5:00-5:30  & 9994 \\ \hline
  5:30-6:00  & 9213 \\ \hline
\end{tabular}  } 
  }
%%Need to make the other 16 signs obv. but I have other things to do right now. this will be done by sign due-date
  
\NEW{SignSmall}{\sRaidGD}{
  %my idea to make this as simple as possible would be that this is a double sheet that you can only look under after you raid the lab.
  \s\MYname	{\cGD{}'s lab space}
  \s\MYloc	{}%%TBD
  \s\MYtext	{You scour through the lab's computers and experimental setups. You are fairly confident that \cGD{} is building a device that will try to send *all* the elementals through the Conduit. The core component of this device is an electromagnet, although it can apparently only function when hooked up to an open connection to the elemental planes. It also requires considerable amounts of power to function.
  
  \emph{If \cGD{} is dead, you should contact a GM now.}
  
  } 
  }
  
  \NEW{SignSmall}{\sRaidSci}{
  %my idea to make this as simple as possible would be that this is a double sheet that you can only look under after you raid the lab.
  \s\MYname	{\cScientist{}'s lab space}
  \s\MYloc	{}%%TBD
  \s\MYtext	{You scour the lab's computers and experimental setups. \cScientist{} keeps very meticulous notes and it is easy to follow \cScientist{\their} line of work. After discovering a strange white powder, \cScientist{} began investigating its properties. It appears to be tightly connected to the elemental biological process, and is possibly related to the steady loss of the elemental's energy levels. There does not appear to be much else that \cScientist{} has been working on lately, besides some recently published papers.
  
  \emph{If \cScientist{} is dead, you should contact a GM now.}
  
  } 
  }
  
  \NEW{SignSmall}{\sRaidMS}{
  %my idea to make this as simple as possible would be that this is a double sheet that you can only look under after you raid the lab.
  \s\MYname	{\cMS{}'s lab space}
  \s\MYloc	{}%%TBD
  \s\MYtext	{You scour the lab's computers and experimental setups. There is quite a lot of highly encrypted or hastily erased data here, but you can still manage to recover some of the projects. \cMS{} is primarialy researching the process by which elementals enslave humans or elementals, and is trying to replicate it. So far as you can tell, the focus is only on enslaving elementals and not humans. So far, \cMS{\they} have managed to create a prototype device in the form of a long rod that can control very weak elementals, but there is also considerable work into Azi tape. \cMS{} has apparently created a new type of tape that can train Azi to enslave much more powerful elementals, although in its current form such tape is very dangerous (and illegal) to use. There is some evidence suggesting that a prototype version of this tape has already been experimented with several years ago.
  
  \emph{If \cMS{} is dead, you should contact a GM now.}
  
  } 
  }
  
\NEW{Sign}{\sLockedDoor}{
  \s\MYname	{A Steel Reinforced, Locked Door}
  \s\MYloc	{-015}
  \s\MYtext	{This steel door is locked.
  
  {\Large You may not pass unless you know otherwise.}
  
  There are two ways to pass this door:
\begin{enumerate}
 \item Possess the appropriate key (item number: \iLabKey{\MYnumber}).
 \item You may hit the door with a {\bf CR of 10} or greater. If you choose to do so, you must write ``Broken'' on the sign indicating that the door is locked. Anyone may now freely pass into the room since the door has been broken down. {\bf Further,} elementals that participate in breaking the door down must write their elemental type on the back of sheet since this action leaves elemental residue on the door. Anyone possessing a \iTricorder{} with ``Detect Elemental Residue'' functionality may look under the sheet to learn the type(s) of elementals that participated in breaking the door down.
\end{enumerate}}
  \s\MYitems {}
}